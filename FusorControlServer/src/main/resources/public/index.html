<!DOCTYPE html>
<!--
To change this license header, choose License Headers in Project Properties.
To change this template file, choose Tools | Templates
and open the template in the editor.
-->
<html>
    <body>        
        <h1>Fusor Control</h1>
        <h2>Arduino Status: <span id="astatus"></span></h2>
        <h2>Variac Status: <span id="vstatus"></span></h2>
        <h2>TMP Status: <span id="pstatus"></span></h2>
        <button class="cbut">meme</button>
        <textarea id="error">
            error message goes here <br>
            when i set this up
        </textarea>
        <hr>
        <h2>testing</h2>
        <button onclick="test()">test</button>
        <button onclick="end()">end test</button>

        <script type="text/javascript">
            var xhr = new XMLHttpRequest();
            var endTest = false;
            
            function request(page, callback) {
                xhr.onreadystatechange = () => {
                    if (this.readyState == 4 && this.status == 200) {
                        callback();
                    }
                }
                xhttp.open("GET", page, true);
                xhttp.send();
            }
            
            function getStatus () {
                request("/", ()=>{
                    console.log(xhr.responseText);
                });
            }

            //there's definitely a better way to do this
            function end() {
                endTest = true;
            }

            //prints out "test recieved" every 0.5 seconds
            //could be achieved with less latency if using WebSocket or Socket.io
            function test() {
                console.log("test recieved");
                if (endTest) {
                    endTest = false;
                    return;
                }
                setTimeout(arguments.callee, 500);
            }
        </script>
    </body>
</html>
